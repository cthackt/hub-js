import { getCategory, getProp } from "@esri/hub-common";
// implements the 'collection' facet from AGO results. V3 datasets have this property computed
// during the harvesting process but AGO results need this result computed at runtime
/**
 * Calculate raw counts for collection based on AGO type aggregations
 * @param agoAggregations aggregations from ago results
 */
export function collectionAgg(agoAggregations) {
    if (agoAggregations === void 0) { agoAggregations = {}; }
    var typeAggs = (getProp(agoAggregations, "counts") || []).filter(function (agg) { return agg.fieldName === "type"; })[0];
    if (!typeAggs)
        return { collection: {} };
    return typeAggs.fieldValues.reduce(function (formattedAggs, fieldVal) {
        var category = getCategory(fieldVal.value);
        var collectionType;
        if (category) {
            // upper case first letter and return as element in array for backwards compatibility
            collectionType = category
                .toLowerCase()
                .split(" ")
                .map(function (word) { return word.charAt(0).toUpperCase() + word.slice(1); })
                .join(" ");
        }
        else {
            collectionType = "Other";
        }
        formattedAggs.collection[collectionType] = fieldVal.count;
        return formattedAggs;
    }, { collection: {} });
}
//# sourceMappingURL=collection.js.map
"use strict";
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
 * Apache-2.0 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.agoSearch = void 0;
const compute_items_facets_1 = require("./compute-items-facets");
const format_item_collection_1 = require("./format-item-collection");
const get_items_1 = require("./get-items");
/**
 * Search for Items in ArcGIS, compute facets and format the response into V3 like datasets
 *
 * @export
 * @param {ISearchParams} params (query params from hub indexer)
 * @param {UserSession} authentication
 * @returns {Promise<ISearchResult>}
 */
async function agoSearch(params, token, portal, authentication) {
    const agoResponse = await get_items_1.getItems(params, token, portal, authentication);
    const facets = await compute_items_facets_1.computeItemsFacets(agoResponse.aggregations, params, token, portal);
    const model = format_item_collection_1.agoFormatItemCollection(agoResponse, facets, params);
    return model;
}
exports.agoSearch = agoSearch;
//# sourceMappingURL=search.js.map
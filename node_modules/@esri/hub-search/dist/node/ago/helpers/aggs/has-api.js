"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasApiAgg = void 0;
const hub_common_1 = require("@esri/hub-common");
const apiTypes = hub_common_1.categories.apiTypes.map((type) => type.toLowerCase());
// implements the 'hasApi' facet from AGO results. V3 datasets have this property computed
// during the harvesting process but AGO results need this result computed at runtime
function hasApiAgg(agoAggregations = {}) {
    const typeAggs = (hub_common_1.getProp(agoAggregations, "counts") || []).filter((agg) => agg.fieldName === "type")[0];
    if (!typeAggs)
        return { hasApi: {} };
    return typeAggs.fieldValues.reduce((formattedAggs, fieldVal) => {
        if (apiTypes.indexOf(fieldVal.value) > -1) {
            formattedAggs.hasApi.true += fieldVal.count;
        }
        else {
            formattedAggs.hasApi.false += fieldVal.count;
        }
        return formattedAggs;
    }, { hasApi: { true: 0, false: 0 } });
}
exports.hasApiAgg = hasApiAgg;
//# sourceMappingURL=has-api.js.map
import { __assign, __awaiter, __generator } from "tslib";
import { getItemStatus, } from "@esri/arcgis-rest-portal";
function delay(milliseconds) {
    return new Promise(function (resolve) { return setTimeout(resolve, milliseconds); });
}
/**
 * Helper function which takes an itemId and checks the status
 * of the item every 2 seconds until it is either complete or failed.
 *
 * @export
 * @param {string} itemId AGO item id
 * @param {IUserRequestOptions} requestOptions
 */
export function _waitForItemReady(itemId, requestOptions) {
    return __awaiter(this, void 0, void 0, function () {
        var statusResult;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, delay(2000)];
                case 1:
                    _a.sent();
                    return [4 /*yield*/, getItemStatus(__assign({ id: itemId }, requestOptions))];
                case 2:
                    statusResult = _a.sent();
                    if (statusResult.status === "failed") {
                        throw new Error(statusResult.statusMessage);
                    }
                    _a.label = 3;
                case 3:
                    if (statusResult.status !== "completed") return [3 /*break*/, 0];
                    _a.label = 4;
                case 4: return [2 /*return*/];
            }
        });
    });
}
//# sourceMappingURL=_wait-for-item-ready.js.map